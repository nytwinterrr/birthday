<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç”Ÿæ—¥å¿«ä¹ ğŸ‚</title>

<style>
html,body{
  margin:0;padding:0;
  width:100%;height:100%;
  overflow:hidden;
  font-family:"PingFang SC","Microsoft YaHei",sans-serif;
  background:linear-gradient(135deg,#f7a7a7,#fbd3d3);
}

#soundUnlock{
  position:fixed;
  bottom:30px;
  right:30px;
  background:#fff;
  color:#f7a7a7;
  padding:12px 18px;
  border-radius:30px;
  font-size:14px;
  cursor:pointer;
  box-shadow:0 5px 20px rgba(0,0,0,0.2);
  z-index:9999;
}

canvas{position:absolute;top:0;left:0;}

.page{
  position:absolute;
  width:100%;height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:#fff;
}

.hidden{display:none;}

input,button{
  padding:10px 18px;
  border-radius:6px;
  border:none;
  font-size:16px;
}

button{cursor:pointer}

/* ===== é‚®ä»¶å›¾æ ‡ ===== */
#mailIcon{
  background:#fff;
  color:#333;
  padding:22px 30px;
  border-radius:18px;
  text-align:center;
  box-shadow:0 15px 40px rgba(0,0,0,.25);
  cursor:pointer;
  animation:pop .8s ease forwards;
}

#mailIcon .title{font-size:20px;font-weight:bold}
#mailIcon .sub{font-size:14px;color:#888;margin-top:6px}

@keyframes pop{
  from{transform:scale(0);opacity:0}
  70%{transform:scale(1.1)}
  to{transform:scale(1);opacity:1}
}

/* ===== é‚®ä»¶çª—å£ ===== */
#mailWindow{
  background:#fff;
  color:#333;
  padding:35px;
  border-radius:22px;
  width:80%;
  max-width:560px;
  box-shadow:0 25px 60px rgba(0,0,0,.3);
  animation:zoom .6s ease forwards;
}

@keyframes zoom{
  from{transform:scale(.6);opacity:0}
  to{transform:scale(1);opacity:1}
}

.mail-content{line-height:1.8;margin-top:14px}

.nextBtn{
  margin-top:25px;
  background:#f7a7a7;
  color:#fff;
  border-radius:20px;
  padding:10px 24px;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>

<audio id="ding">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-message-pop-alert-2354.mp3" type="audio/mpeg">
</audio>

<audio id="bgm" loop>
  <source src="qingchunbudayang.mp3" type="audio/mpeg">
</audio>

<div id="soundUnlock">ğŸ”Š ç‚¹æˆ‘å¼€å¯å£°éŸ³</div>

<!-- Page 1 -->
<div class="page" id="page1">
  <h2>ç”Ÿæ—¥å¿«ä¹</h2>
  <input id="nameInput" placeholder="è¾“å…¥åå­—"><br><br>
  <button onclick="start()">è¿›å…¥</button>
</div>

<!-- Page 2 (ç²’å­æ–‡å­—) -->
<div class="page hidden" id="page2"></div>

<!-- é‚®ä»¶é¡µ 9~15 -->
<div class="page hidden" id="mailPage">
  <div id="mailIcon" onclick="openMail()">
    <div class="title">ğŸ“© ä½ æœ‰é‚®ä»¶å¯æŸ¥æ”¶</div>
    <div class="sub">ç‚¹æˆ‘æ‰“å¼€</div>
  </div>

  <div id="mailWindow" class="hidden">
    <h3>ğŸ“¬ æ–°é‚®ä»¶</h3>
    <p><strong>å†™ä¿¡äººï¼š</strong><span id="sender"></span></p>
    <p class="mail-content" id="content"></p>
    <button class="nextBtn" onclick="nextMail()">ä¸‹ä¸€å°</button>
  </div>
</div>

<script>
// ===== Canvas æ–¹å— =====
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth; canvas.height=innerHeight;

let squares=[],showSquares=true;
function createSquares(n=15){
  squares=[];
  for(let i=0;i<n;i++){
    squares.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height,
      size:30+Math.random()*60,
      angle:Math.random()*Math.PI,
      rotate:(Math.random()-.5)*.05,
      speed:(Math.random()-.5)*.2,
      alpha:.2+Math.random()*.3
    });
  }
}
function drawSquares(){
  squares.forEach(s=>{
    s.angle+=s.rotate;
    s.y+=s.speed;
    if(s.y>canvas.height+30)s.y=-30;
    if(s.y<-30)s.y=canvas.height+30;
    ctx.save();
    ctx.translate(s.x,s.y);
    ctx.rotate(s.angle);
    ctx.fillStyle=`rgba(255,210,220,${s.alpha})`;
    ctx.fillRect(-s.size/2,-s.size/2,s.size,s.size);
    ctx.restore();
  });
}

// ===== ç²’å­æ–‡å­— =====
let particles=[];
function createParticles(text){
  particles=[];
  ctx.clearRect(0,0,canvas.width,canvas.height);
  let fontSize = 120;
  if(text.length>5) fontSize = 90;
  ctx.font=`bold ${fontSize}px Arial`;
  const x=(canvas.width-ctx.measureText(text).width)/2;
  const y=canvas.height/2;
  ctx.fillText(text,x,y);

  const data=ctx.getImageData(0,0,canvas.width,canvas.height).data;
  for(let py=0;py<canvas.height;py+=6){
    for(let px=0;px<canvas.width;px+=6){
      if(data[(py*canvas.width+px)*4+3]>150){
        particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,tx:px,ty:py});
      }
    }
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(showSquares) drawSquares();
  particles.forEach(p=>{
    p.x+=(p.tx-p.x)*.2;
    p.y+=(p.ty-p.y)*.08;
    ctx.fillStyle="#fff";
    ctx.fillRect(p.x,p.y,3,3);
  });
  requestAnimationFrame(animate);
}

// ===== é¡µé¢é€»è¾‘ =====
const pages=["Hi ","ç¥ä½ ","ç”Ÿæ—¥å¿«ä¹","Happy Birthday","3","2","1"];
let idx=0;

function start(){
  pages[0]="Hi "+(nameInput.value||"ä½ ");
  page1.classList.add("hidden");
  page2.classList.remove("hidden");
  showSquares=false;
  next();
}

function next(){
  if(idx>pages.length-1){ showSquares=true; showMail(); return; }
  createParticles(pages[idx++]);
  setTimeout(next,1500);
}

// ===== é‚®ä»¶æ•°æ® 9~15é¡µ =====
const mails=[
  {s:"å°é±¼",c:"ç”Ÿæ—¥å¿«ä¹ï¼æ„¿ä½ æ–°çš„ä¸€å²ï¼Œå¸¸æ€€å–œæ‚¦ï¼Œä¸‡äº‹é¡ºé€ï¼Œæ‰€æœ‰ç¾å¥½éƒ½å¦‚æœŸè€Œè‡³ã€‚å½“ç„¶æœ€é‡è¦çš„æ˜¯ä¸€å®šä¼šèµšå¤§é’±ï¼ï¼ï¼"},
  {s:"0814",c:"ç¥çš‡ä¸Šç”Ÿæ—¥å¿«ä¹ï¼Œä¹‹åä¸ä¼šä¸ºç”Ÿæ´»ä¸­çš„ä¸€äº›çäº‹çƒ¦å¿ƒï¼Œäº‹äº‹é¡ºå¿ƒï¼Œä¹Ÿç¥çš‡ä¸Šå¹¸ç¦å®‰åº·ä¸€ç›´éƒ½å¿«å¿«ä¹ä¹çš„"},
  {s:"é•œå­",c:"çš‡ä¸Šç”Ÿæ—¥å¿«ä¹ï¼å¸Œæœ›å‡†ç« åœ¨æ–°çš„ä¸€å²å¯ä»¥æ¯å¤©å¼€å¿ƒï¼Œèµšç‰¹åˆ«å¤šçš„é’±ï¼Œä¸‡äº‹å¦‚æ„ï¼"},
  {s:"æ—è§º",c:"çš‡ä¸Šç”Ÿæ—¥å¿«ä¹ï¼å¸Œæœ›ä½ åœ¨æ–°çš„ä¸€å²é‡Œï¼Œäº‹ä¸šå¦‚æ˜¥æ ‘æ¸èŒ‚ï¼Œç”Ÿæ´»å¦‚æ¸…èŒ¶å›ç”˜ï¼Œæœ‰ç»†ç¢çš„æ¸©æš–ï¼Œä¹Ÿæœ‰é•¿ä¹…çš„å®‰å®ã€‚æ›´å¸Œæœ›ä½ å§‹ç»ˆè¢«å¹³å®‰ä¿ä½‘ï¼Œå‰è·¯å°‘ä¸€äº›åå·ï¼Œå¿ƒä¸­å¤šä¸€äº›æ™´æœ—ã€‚å²å²æ¬¢å–œï¼Œä¸‡äº‹çš†å®œã€‚"},
  {s:"å¤§ç±³é¥­",c:"ç¥ä¸«å¤´æ–°çš„ä¸€å²ç²‰ä¸ç ´ä¸‡ï¼Œç›´æ’­é—´è¶Šæ¥è¶Šçƒ­é—¹ï¼Œæ²¡æœ‰è´¢å¯Œç„¦è™‘"},
  {s:"ä¸€åæ¥è‡ªä¸æ„¿æ„é€éœ²å§“åçš„ä¸çŸ¥åæ¤ç‰©",c:"ç¥ä¸«å¤´æ–°çš„ä¸€å²å¤©å¤©å¼€å¿ƒï¼Œç›´æ’­é¡ºåˆ©ï¼Œæ‰¾å·¥ä½œä¹Ÿæ˜¯ä¸ç”¨æ„ï¼Œç­‰å’±æ”’å¤Ÿç±³äº†å†è¡¥ç”Ÿæ—¥ç¤¼ç‰©ã€‚"},
  {s:"å°æ¬£",c:"ç”Ÿæ—¥å¿«ä¹ï¼ä»Šå¤©ä½ æœ€å¤§ï¼Œæœ‰ä»€ä¹ˆå©å’å°½ç®¡è¯´~ï¼ˆå½“ç„¶å¹³æ—¶ä¹Ÿå¬ä½ çš„ï¼‰"},
  {s:"æŸ æª¬æ°´",c:"ç¥ä¸«å¤´ç”Ÿæ—¥å¿«ä¹ï¼å¤©å¤©å¼€å¿ƒï¼Œæ—¥è¿›æ–—é‡‘ï¼"}
];

let mailIndex=0;

function showMail(){
  page2.classList.add("hidden");
  mailPage.classList.remove("hidden");
  loadMail();
}

function loadMail(){
  sender.innerText = mails[mailIndex].s;
  content.innerText = mails[mailIndex].c;
  mailIcon.classList.remove("hidden");
  mailWindow.classList.add("hidden");
}

function openMail(){
  ding.play();
  mailIcon.classList.add("hidden");
  mailWindow.classList.remove("hidden");
}

function nextMail(){
  mailIndex++;
  if(mailIndex>=mails.length){
    alert("æ‰€æœ‰é‚®ä»¶å·²æŸ¥æ”¶å®Œæ¯• ğŸ’Œ");
    return;
  }
  loadMail();
}

// ===== åˆå§‹åŒ– =====
createSquares();
animate();

const bgm = document.getElementById("bgm");
const ding = document.getElementById("ding");

document.getElementById("soundUnlock").onclick = ()=>{
  bgm.volume = 0.6;
  bgm.currentTime = 36; // ä»36ç§’å¼€å§‹
  bgm.play().catch(e=>console.log("æ’­æ”¾å¤±è´¥",e));
  document.getElementById("soundUnlock").style.display="none";
};
</script>

</body>
</html>
